"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9757],{79757:(e,l,a)=>{a.r(l),a.d(l,{UploadComponent:()=>x});var t=a(90750),o=a(93916),s=a(28951),n=a(48643),c=a(95155),i=a(94271),d=a(31424),r=a(25866),u=a(92825),p=a(77168),h=a(32532),m=a(12115),b="lexical-upload",g={depth:0},v=e=>{var l,a,v,x;let{data:{fields:_,relationTo:f,value:j},nodeKey:w}=e;if("object"==typeof j)throw Error("Upload value should be a string or number. The Lexical Upload component should not receive the populated value object.");let{config:{routes:{api:C},serverURL:D},getEntityConfig:N}=(0,r.b)(),S=(0,m.useRef)(null),{uuid:k}=(0,n.b)(),y=(0,u.useEditDepth)(),[P]=(0,i.DF)(),{editorConfig:R,fieldProps:{readOnly:E,schemaPath:U}}=(0,n.b)(),{i18n:B,t:F}=(0,p.d)(),[L,T]=(0,m.useReducer)(e=>e+1,0),[K]=(0,m.useState)(()=>N({collectionSlug:f})),I=(0,m.useId)(),z=(0,u.formatDrawerSlug)({slug:"lexical-upload-drawer-"+k+I,depth:y}),{toggleDrawer:A}=(0,o.a)(z,!0),{closeDocumentDrawer:M,DocumentDrawer:O,DocumentDrawerToggler:q}=(0,s.a)({id:j,collectionSlug:K.slug}),[{data:G},{setParams:H}]=(0,u.usePayloadAPI)("".concat(D).concat(C,"/").concat(K.slug,"/").concat(j),{initialParams:g}),J=(null==G?void 0:G.thumbnailURL)||(null==G?void 0:G.url),Q=(0,m.useCallback)(()=>{P.update(()=>{var e;null==(e=(0,h.nsf)(w))||e.remove()})},[P,w]),V=(0,m.useCallback)(e=>{H({...g,cacheBust:L}),T(),M()},[H,L,M]),W=null==R||null==(x=R.resolvedFeatureMap)||null==(v=x.get("upload"))||null==(a=v.sanitizedClientFeatureProps.collections)||null==(l=a[K.slug])?void 0:l.hasExtraFields,X=(0,m.useCallback)((e,l)=>{P.update(()=>{let e=(0,h.nsf)(w);if(e){let a={...e.getData(),fields:l};e.setData(a)}})},[P,w]);return(0,c.jsxs)("div",{className:b,contentEditable:!1,ref:S,children:[(0,c.jsxs)("div",{className:"".concat(b,"__card"),children:[(0,c.jsxs)("div",{className:"".concat(b,"__topRow"),children:[(0,c.jsx)("div",{className:"".concat(b,"__thumbnail"),children:J?(0,c.jsx)("img",{alt:null==G?void 0:G.filename,"data-lexical-upload-id":j,"data-lexical-upload-relation-to":f,src:J}):(0,c.jsx)(u.File,{})}),(0,c.jsxs)("div",{className:"".concat(b,"__topRowRightPanel"),children:[(0,c.jsx)("div",{className:"".concat(b,"__collectionLabel"),children:(0,d.sC)(K.labels.singular,B)}),P.isEditable()&&(0,c.jsxs)("div",{className:"".concat(b,"__actions"),children:[W?(0,c.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(b,"__upload-drawer-toggler"),disabled:E,el:"button",icon:"edit",onClick:()=>{A()},round:!0,tooltip:F("fields:editRelationship")}):null,(0,c.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(b,"__swap-drawer-toggler"),disabled:E,el:"button",icon:"swap",onClick:()=>{P.dispatchCommand(t.c,{replace:{nodeKey:w}})},round:!0,tooltip:F("fields:swapUpload")}),(0,c.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(b,"__removeButton"),disabled:E,icon:"x",onClick:e=>{e.preventDefault(),Q()},round:!0,tooltip:F("fields:removeUpload")})]})]})]}),(0,c.jsx)("div",{className:"".concat(b,"__bottomRow"),children:(0,c.jsx)(q,{className:"".concat(b,"__doc-drawer-toggler"),children:(0,c.jsx)("strong",{children:null==G?void 0:G.filename})})})]}),j?(0,c.jsx)(O,{onSave:V}):null,W?(0,c.jsx)(t.a,{data:_,drawerSlug:z,drawerTitle:F("general:editLabel",{label:(0,d.sC)(K.labels.singular,B)}),featureKey:"upload",handleDrawerSubmit:X,schemaPath:U,schemaPathSuffix:K.slug}):null]})},x=e=>(0,c.jsx)(t.b,{...e,uploads:!0,children:(0,c.jsx)(v,{...e})})}}]);